<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Sandstone Model &mdash; GeMpy 2 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="GeMpy 2 documentation" href="../GeMpy Introduction.html" />
    <link rel="next" title="Project" href="../project.html" />
    <link rel="prev" title="Tutorial" href="../tutorial.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class^=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: #D84315;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span># Importing
import theano.tensor as T
import sys, os
sys.path.append(&quot;../GeMpy&quot;)
sys.path.append(&quot;../pygeomod&quot;)

import GeMpy_core
import Visualization

import importlib
importlib.reload(GeMpy_core)
importlib.reload(Visualization)
import numpy as np
import pandas as pn
from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt

os.environ[&#39;CUDA_LAUNCH_BLOCKING&#39;] = &#39;1&#39;
np.set_printoptions(precision = 6, linewidth= 130, suppress =  True)

%matplotlib inline
#%matplotlib notebook
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="stderr container">
<div class="highlight"><pre>
Using gpu device 0: GeForce GTX 970 (CNMeM is disabled, cuDNN not available)
</pre></div></div>
</div>
<div class="section" id="Sandstone-Model">
<h1>Sandstone Model<a class="headerlink" href="#Sandstone-Model" title="Permalink to this headline">Â¶</a></h1>
<p>First we make a GeMpy instance with most of the parameters default
(except range that is given by the project). Then we also fix the
extension and the resolution of the domain we want to interpolate.
Finally we compile the function, only needed once every time we open the
project (the guys of theano they are working on letting loading compiled
files, even though in our case it is not a big deal).</p>
<p><em>General note. So far the reescaling factor is calculated for all series
at the same time. GeoModeller does it individually for every potential
field. I have to look better what this parameter exactly means</em></p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span># Setting extend, grid and compile
# Setting the extent
sandstone = GeMpy_core.GeMpy()

# Create Data class with raw data
sandstone.import_data( 696000,747000,6863000,6950000,-20000, 2000, 40, 40, 80,
                                     path_f = os.pardir+&quot;/input_data/a_Foliations.csv&quot;,
                                     path_i = os.pardir+&quot;/input_data/a_Points.csv&quot;)

sandstone.Data.set_series({&quot;EarlyGranite_Series&quot;:sandstone.Data.formations[-1],
                      &quot;BIF_Series&quot;:(sandstone.Data.formations[0], sandstone.Data.formations[1]),
                      &quot;SimpleMafic_Series&quot;:sandstone.Data.formations[2]},
                       order = [&quot;EarlyGranite_Series&quot;,
                              &quot;BIF_Series&quot;,
                              &quot;SimpleMafic_Series&quot;])
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[2]:
</pre></div>
</div>
<div class="container">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EarlyGranite_Series</th>
      <th>BIF_Series</th>
      <th>SimpleMafic_Series</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>EarlyGranite</td>
      <td>SimpleMafic2</td>
      <td>SimpleMafic1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>EarlyGranite</td>
      <td>SimpleBIF</td>
      <td>SimpleMafic1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>All input data is stored in pandas dataframes under,
<code class="docutils literal"><span class="pre">self.Data.Interances</span></code> and <code class="docutils literal"><span class="pre">self.Data.Foliations</span></code>:</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>sandstone.Data.Foliations;
</pre></div>
</div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span># Create a class Grid so far just regular grid
sandstone.create_grid()
sandstone.Grid.grid
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[4]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>array([[  696000.      ,  6863000.      ,   -20000.      ],
       [  696000.      ,  6863000.      ,   -19721.519531],
       [  696000.      ,  6863000.      ,   -19443.037109],
       ...,
       [  747000.      ,  6950000.      ,     1443.037964],
       [  747000.      ,  6950000.      ,     1721.519043],
       [  747000.      ,  6950000.      ,     2000.      ]], dtype=float32)
</pre></div>
</div>
</div>
<div class="section" id="Plotting-raw-data">
<h2>Plotting raw data<a class="headerlink" href="#Plotting-raw-data" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>sandstone.Plot.plot_data(serie = sandstone.Data.series.columns.values[1])
</pre></div>
</div>
</div>
<div class="nboutput container">
<div class="container">
</div>
<div class="stderr container">
<div class="highlight"><pre>
/home/miguel/anaconda3/lib/python3.5/site-packages/matplotlib/font_manager.py:1288: UserWarning: findfont: Font family [&#39;Times New Roman&#39;] not found. Falling back to Bitstream Vera Sans
  (prop.get_family(), self.defaultFamily[fontext]))
</pre></div></div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<img alt="Notebook1/../../build/doctrees/nbsphinx/Notebook1_SandstoneProject_8_1.png" src="Notebook1/../../build/doctrees/nbsphinx/Notebook1_SandstoneProject_8_1.png" />
</div>
</div>
</div>
<div class="section" id="Class-Interpolator">
<h2>Class Interpolator<a class="headerlink" href="#Class-Interpolator" title="Permalink to this headline">Â¶</a></h2>
<p>This class will take the data from the class Data and calculate
potential fields and block</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>sandstone.set_interpolator(range_var = 110000)
</pre></div>
</div>
</div>
</div>
<div class="section" id="Early-granite">
<h2>Early granite<a class="headerlink" href="#Early-granite" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>sandstone.Plot.plot_potential_field(10, n_pf=0)
</pre></div>
</div>
</div>
<div class="nboutput container">
<div class="container">
</div>
<div class="stderr container">
<div class="highlight"><pre>
/home/miguel/anaconda3/lib/python3.5/site-packages/matplotlib/font_manager.py:1288: UserWarning: findfont: Font family [&#39;Times New Roman&#39;] not found. Falling back to Bitstream Vera Sans
  (prop.get_family(), self.defaultFamily[fontext]))
</pre></div></div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<img alt="Notebook1/../../build/doctrees/nbsphinx/Notebook1_SandstoneProject_13_1.png" src="Notebook1/../../build/doctrees/nbsphinx/Notebook1_SandstoneProject_13_1.png" />
</div>
</div>
</div>
<div class="section" id="BIF-Series">
<h2>BIF Series<a class="headerlink" href="#BIF-Series" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>sandstone.Plot.plot_potential_field(13, n_pf=1, cmap = &quot;magma&quot;,  plot_data = True,
                                        verbose = 5 )
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<img alt="Notebook1/../../build/doctrees/nbsphinx/Notebook1_SandstoneProject_15_0.png" src="Notebook1/../../build/doctrees/nbsphinx/Notebook1_SandstoneProject_15_0.png" />
</div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>sandstone.Interpolator.a_T.get_value()
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[9]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>array(103218.21544669333)
</pre></div>
</div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>sandstone.Interpolator.rescaling_factor_T.get_value()
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[10]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>array(48561.5)
</pre></div>
</div>
</div>
</div>
<div class="section" id="SImple-mafic">
<h2>SImple mafic<a class="headerlink" href="#SImple-mafic" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>sandstone.Plot.plot_potential_field(10, n_pf=2)
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<img alt="Notebook1/../../build/doctrees/nbsphinx/Notebook1_SandstoneProject_19_0.png" src="Notebook1/../../build/doctrees/nbsphinx/Notebook1_SandstoneProject_19_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Optimizing-the-export-of-lithologies">
<h1>Optimizing the export of lithologies<a class="headerlink" href="#Optimizing-the-export-of-lithologies" title="Permalink to this headline">Â¶</a></h1>
<p>Here I am going to try to return from the theano interpolate function
the internal type of the result (in this case DK I guess) so I can make
another function in python I guess to decide which potential field I
calculate at every grid_pos</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span># Reset the block
sandstone.Interpolator.block.set_value(np.zeros_like(sandstone.Grid.grid[:,0]))

# Compute the block
sandstone.Interpolator.compute_block_model([0,1,2], verbose = 4)
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
4
[1 1 1 ..., 1 1 1] 0
The serie formations are EarlyGranite
The formations are:
Layers               X          Y           Z     formation               series
43  745312.750  6878221.0  452.733051  EarlyGranite  EarlyGranite_Series
44  741494.625  6877535.5  460.202350  EarlyGranite  EarlyGranite_Series
45  735914.188  6876556.5  456.482389  EarlyGranite  EarlyGranite_Series
46  734739.375  6874011.0  446.031913  EarlyGranite  EarlyGranite_Series
47  733564.563  6874598.5  452.620638  EarlyGranite  EarlyGranite_Series
48  734837.313  6876850.5  469.895650  EarlyGranite  EarlyGranite_Series
49  735326.813  6881354.0  492.347775  EarlyGranite  EarlyGranite_Series
50  733858.313  6882724.5  486.360734  EarlyGranite  EarlyGranite_Series
51  731508.625  6881941.0  476.162317  EarlyGranite  EarlyGranite_Series
52  729746.438  6879004.0  468.440123  EarlyGranite  EarlyGranite_Series
53  727788.375  6878514.5  465.162276  EarlyGranite  EarlyGranite_Series
54  729354.813  6881354.0  469.466421  EarlyGranite  EarlyGranite_Series
55  729159.000  6884095.0  480.639992  EarlyGranite  EarlyGranite_Series
56  726319.875  6884389.0  472.411447  EarlyGranite  EarlyGranite_Series
57  723284.938  6882235.0  475.413461  EarlyGranite  EarlyGranite_Series
58  721522.688  6879591.5  471.253042  EarlyGranite  EarlyGranite_Series
59  720935.313  6881941.0  492.156175  EarlyGranite  EarlyGranite_Series
60  720445.813  6883703.5  498.308040  EarlyGranite  EarlyGranite_Series
61  717410.875  6883507.5  507.584619  EarlyGranite  EarlyGranite_Series
62  714571.688  6882039.0  506.534612  EarlyGranite  EarlyGranite_Series
63  711243.063  6879493.5  505.437117  EarlyGranite  EarlyGranite_Series
64  709676.625  6881549.5  515.202397  EarlyGranite  EarlyGranite_Series
65  710264.063  6883899.5  524.055665  EarlyGranite  EarlyGranite_Series
66  707914.438  6882724.5  507.245636  EarlyGranite  EarlyGranite_Series
67  703802.563  6877340.0  483.052807  EarlyGranite  EarlyGranite_Series
68  699886.500  6872934.5  470.146586  EarlyGranite  EarlyGranite_Series
69  697047.375  6869214.0  456.299059  EarlyGranite  EarlyGranite_Series
 Foliations                X           Y           Z     azimuth   dip  polarity  \
15  743403.6875  6877878.25  454.749952  169.802194  80.0         1
16  738704.4065  6877046.00  458.148740  170.056246  80.0         1
17  735326.7815  6875283.75  452.966456  114.812185  80.0         1
18  734151.9690  6874304.75  448.179887  206.518042  80.0         1
19  734200.9380  6875724.50  461.985804  299.406115  80.0         1
20  735082.0630  6879102.25  480.551436  276.153239  80.0         1
21  734592.5630  6882039.25  487.287083  223.053093  80.0         1
22  732683.4690  6882332.75  481.711952  161.600709  80.0         1
23  730627.5315  6880472.50  477.402658  120.986348  80.0         1
24  728767.4065  6878759.25  470.031623  165.980598  80.0         1
25  728571.5940  6879934.25  472.536776  298.870347  80.0         1
26  729256.9065  6882724.50  471.722924  265.872737  80.0         1
27  727739.4375  6884242.00  474.258726  185.941204  80.0         1
28  724802.4065  6883312.00  473.707869  144.627207  80.0         1
29  722403.8130  6880913.25  470.707065  123.702047  80.0         1
30  721229.0005  6880766.25  477.680894  255.876557  80.0         1
31  720690.5630  6882822.25  489.909423  254.444427  80.0         1
32  718928.3440  6883605.50  509.462245  176.274084  80.0         1
33  715991.2815  6882773.25  505.165864  152.654159  80.0         1
34  712907.3755  6880766.25  512.582136  142.596411  80.0         1
35  710459.8440  6880521.50  511.839758  232.658556  80.0         1
36  709970.3440  6882724.50  532.967915  283.997896  80.0         1
37  709089.2505  6883312.00  519.457428  153.495937  80.0         1
38  705858.5005  6880032.25  494.307044  127.403250  80.0         1
39  701844.5315  6875137.25  476.658525  131.656118  80.0         1
40  698466.9375  6871074.25  463.972201  127.377257  80.0         1

       formation               series       G_x       G_y       G_z
15  EarlyGranite  EarlyGranite_Series  0.174357 -0.969250  0.173648
16  EarlyGranite  EarlyGranite_Series  0.170058 -0.970014  0.173648
17  EarlyGranite  EarlyGranite_Series  0.893898 -0.413270  0.173648
18  EarlyGranite  EarlyGranite_Series -0.439697 -0.881200  0.173648
19  EarlyGranite  EarlyGranite_Series -0.857927  0.483537  0.173648
20  EarlyGranite  EarlyGranite_Series -0.979134  0.105560  0.173648
21  EarlyGranite  EarlyGranite_Series -0.672304 -0.719620  0.173648
22  EarlyGranite  EarlyGranite_Series  0.310842 -0.934464  0.173648
23  EarlyGranite  EarlyGranite_Series  0.844266 -0.507012  0.173648
24  EarlyGranite  EarlyGranite_Series  0.238570 -0.955474  0.173648
25  EarlyGranite  EarlyGranite_Series -0.862410  0.475494  0.173648
26  EarlyGranite  EarlyGranite_Series -0.982254 -0.070879  0.173648
27  EarlyGranite  EarlyGranite_Series -0.101935 -0.979518  0.173648
28  EarlyGranite  EarlyGranite_Series  0.570099 -0.803015  0.173648
29  EarlyGranite  EarlyGranite_Series  0.819295 -0.546444  0.173648
30  EarlyGranite  EarlyGranite_Series -0.955039 -0.240305  0.173648
31  EarlyGranite  EarlyGranite_Series -0.948735 -0.264099  0.173648
32  EarlyGranite  EarlyGranite_Series  0.063996 -0.982726  0.173648
33  EarlyGranite  EarlyGranite_Series  0.452382 -0.874755  0.173648
34  EarlyGranite  EarlyGranite_Series  0.598197 -0.782308  0.173648
35  EarlyGranite  EarlyGranite_Series -0.782957 -0.597349  0.173648
36  EarlyGranite  EarlyGranite_Series -0.955564  0.238211  0.173648
37  EarlyGranite  EarlyGranite_Series  0.439482 -0.881307  0.173648
38  EarlyGranite  EarlyGranite_Series  0.782312 -0.598193  0.173648
39  EarlyGranite  EarlyGranite_Series  0.735797 -0.654561  0.173648
40  EarlyGranite  EarlyGranite_Series  0.782583 -0.597838  0.173648
number_formations [4]
[1 2]
[1 1 1 ..., 1 1 1] 11401
The serie formations are SimpleMafic2|SimpleBIF
The formations are:
Layers                  X             Y            Z     formation      series
0   735484.817806  6.891936e+06 -1819.319309  SimpleMafic2  BIF_Series
1   729854.915982  6.891938e+06 -1432.263309  SimpleMafic2  BIF_Series
2   724084.267161  6.891939e+06 -4739.830309  SimpleMafic2  BIF_Series
3   733521.625000  6.895282e+06   521.555240  SimpleMafic2  BIF_Series
4   721933.375000  6.884592e+06   496.669295  SimpleMafic2  BIF_Series
5   724251.000000  6.886909e+06   484.550926  SimpleMafic2  BIF_Series
6   727316.313000  6.886460e+06   478.254423  SimpleMafic2  BIF_Series
7   729858.250000  6.887134e+06   484.259574  SimpleMafic2  BIF_Series
8   732699.250000  6.885040e+06   494.526481  SimpleMafic2  BIF_Series
9   716849.500000  6.887358e+06   508.981894  SimpleMafic2  BIF_Series
10  719017.625000  6.892218e+06   508.179387  SimpleMafic2  BIF_Series
11  739179.440691  6.891936e+06  -552.591309     SimpleBIF  BIF_Series
12  735564.599804  6.891936e+06 -2652.196309     SimpleBIF  BIF_Series
13  730009.009977  6.891938e+06 -2088.409309     SimpleBIF  BIF_Series
14  718795.791326  6.891941e+06 -2773.169309     SimpleBIF  BIF_Series
15  724143.386160  6.891939e+06 -5569.907309     SimpleBIF  BIF_Series
16  723877.188000  6.899768e+06   529.152169     SimpleBIF  BIF_Series
17  732998.313000  6.898049e+06   521.619609     SimpleBIF  BIF_Series
18  743689.438000  6.891769e+06   512.811278     SimpleBIF  BIF_Series
19  712961.813000  6.882722e+06   547.826016     SimpleBIF  BIF_Series
20  716284.875000  6.891346e+06   515.586860     SimpleBIF  BIF_Series
21  718942.875000  6.897600e+06   538.490136     SimpleBIF  BIF_Series
22  722157.625000  6.882947e+06   481.747055     SimpleBIF  BIF_Series
23  723952.000000  6.885488e+06   480.122832     SimpleBIF  BIF_Series
24  728736.813000  6.885488e+06   477.929009     SimpleBIF  BIF_Series
25  738829.813000  6.878087e+06   470.081431     SimpleBIF  BIF_Series
 Foliations                 X             Y            Z  azimuth   dip  polarity  \
0  739426.627684  6.891935e+06    75.422691    220.0  70.0         1
1  717311.112372  6.891941e+06 -1497.488309     90.0  60.0         1

   formation      series       G_x           G_y      G_z
0  SimpleBIF  BIF_Series -0.604023 -7.198463e-01  0.34202
1  SimpleBIF  BIF_Series  0.866025  5.302876e-17  0.50000
number_formations [1 2]
3
[1 1 1 ..., 1 1 1] 14112
The serie formations are SimpleMafic1
The formations are:
Layers                  X             Y            Z     formation              series
26  715522.708428  6.891941e+06 -2810.185309  SimpleMafic1  SimpleMafic_Series
27  722100.017223  6.891940e+06 -5640.110309  SimpleMafic1  SimpleMafic_Series
28  728133.723035  6.891938e+06 -8458.173309  SimpleMafic1  SimpleMafic_Series
29  733022.378883  6.891937e+06 -7358.592309  SimpleMafic1  SimpleMafic_Series
30  737972.021729  6.891936e+06 -5589.549309  SimpleMafic1  SimpleMafic_Series
31  726443.009736  6.905713e+06 -5023.656995  SimpleMafic1  SimpleMafic_Series
32  727109.335202  6.886863e+06 -6720.406176  SimpleMafic1  SimpleMafic_Series
33  726266.236469  6.901754e+06 -5708.065297  SimpleMafic1  SimpleMafic_Series
34  732617.810926  6.902964e+06 -3068.116297  SimpleMafic1  SimpleMafic_Series
35  709728.250000  6.885850e+06   532.936577  SimpleMafic1  SimpleMafic_Series
36  714271.063000  6.897386e+06   536.831254  SimpleMafic1  SimpleMafic_Series
37  722693.188000  6.907492e+06   555.452867  SimpleMafic1  SimpleMafic_Series
38  725092.188000  6.913005e+06   514.864987  SimpleMafic1  SimpleMafic_Series
39  744692.688000  6.890291e+06   496.019711  SimpleMafic1  SimpleMafic_Series
40  738924.813000  6.900194e+06   551.633725  SimpleMafic1  SimpleMafic_Series
41  729430.813000  6.908718e+06   517.178069  SimpleMafic1  SimpleMafic_Series
42  726929.750000  6.916017e+06   502.161614  SimpleMafic1  SimpleMafic_Series
 Foliations                  X             Y            Z  azimuth     dip  polarity  \
2   723415.321182  6.891939e+06 -5298.154309   10.000  20.000         1
3   742907.686575  6.891935e+06 -2786.869309  250.000  60.000         1
4   712584.536312  6.891942e+06  -582.769334   90.014  60.000         1
5   724309.279198  6.905712e+06 -3763.862995   90.000  50.000         1
6   728653.933257  6.905715e+06 -4196.807995  269.962   9.090         1
7   732788.182361  6.905718e+06 -1680.306995  269.962  60.000         1
8   727261.874621  6.877214e+06 -5666.992176  360.000  20.000         1
9   718902.531298  6.900479e+06 -1882.895297   83.123  20.726         1
10  733335.732778  6.903151e+06 -1538.629297  255.407  51.633         1
11  730820.452963  6.902599e+06 -3825.776297  258.709  21.801         1
12  725461.656000  6.915002e+06   510.686328  103.095  60.000         1
13  726102.312000  6.917776e+06   499.040304    0.000 -60.000         1
14  727390.156000  6.913487e+06   517.569243   71.561 -60.000         1

       formation              series           G_x           G_y       G_z
2   SimpleMafic1  SimpleMafic_Series  5.939117e-02  3.368241e-01  0.939693
3   SimpleMafic1  SimpleMafic_Series -8.137977e-01 -2.961981e-01  0.500000
4   SimpleMafic1  SimpleMafic_Series  8.660254e-01 -2.116099e-04  0.500000
5   SimpleMafic1  SimpleMafic_Series  7.660444e-01  4.690669e-17  0.642788
6   SimpleMafic1  SimpleMafic_Series -1.579857e-01 -1.047801e-04  0.987441
7   SimpleMafic1  SimpleMafic_Series -8.660252e-01 -5.743698e-04  0.500000
8   SimpleMafic1  SimpleMafic_Series -8.377077e-17  3.420201e-01  0.939693
9   SimpleMafic1  SimpleMafic_Series  3.513532e-01  4.237530e-02  0.935284
10  SimpleMafic1  SimpleMafic_Series -7.587576e-01 -1.975426e-01  0.620696
11  SimpleMafic1  SimpleMafic_Series -3.641961e-01 -7.271406e-02  0.928479
12  SimpleMafic1  SimpleMafic_Series  8.435051e-01 -1.962122e-01  0.500000
13  SimpleMafic1  SimpleMafic_Series -0.000000e+00 -8.660254e-01  0.500000
14  SimpleMafic1  SimpleMafic_Series -8.215645e-01 -2.739194e-01  0.500000
number_formations [3]
</pre></div></div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>sandstone.Plot.plot_block_section(13, direction=&#39;y&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<img alt="Notebook1/../../build/doctrees/nbsphinx/Notebook1_SandstoneProject_22_0.png" src="Notebook1/../../build/doctrees/nbsphinx/Notebook1_SandstoneProject_22_0.png" />
</div>
</div>
</div>
<div class="section" id="Export-vtk">
<h1>Export vtk<a class="headerlink" href="#Export-vtk" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>&quot;&quot;&quot;Export model to VTK

Export the geology blocks to VTK for visualisation of the entire 3-D model in an
external VTK viewer, e.g. Paraview.

..Note:: Requires pyevtk, available for free on: https://github.com/firedrakeproject/firedrake/tree/master/python/evtk

**Optional keywords**:
    - *vtk_filename* = string : filename of VTK file (default: output_name)
    - *data* = np.array : data array to export to VKT (default: entire block model)
&quot;&quot;&quot;
vtk_filename = &quot;noddyFunct2&quot;

extent_x = 10
extent_y = 10
extent_z = 10

delx = 0.2
dely = 0.2
delz = 0.2
from pyevtk.hl import gridToVTK
# Coordinates
x = np.arange(0, extent_x + 0.1*delx, delx, dtype=&#39;float64&#39;)
y = np.arange(0, extent_y + 0.1*dely, dely, dtype=&#39;float64&#39;)
z = np.arange(0, extent_z + 0.1*delz, delz, dtype=&#39;float64&#39;)

# self.block = np.swapaxes(self.block, 0, 2)
gridToVTK(vtk_filename, x, y, z, cellData = {&quot;geology&quot; : sol})
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">ImportError</span>                               Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-14-ff637538da86&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">     19</span> dely <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-cyan-intense-fg ansi-bold">0.2</span>
<span class="ansi-green-fg">     20</span> delz <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-cyan-intense-fg ansi-bold">0.2</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 21</span><span class="ansi-yellow-intense-fg ansi-bold"> </span><span class="ansi-green-intense-fg ansi-bold">from</span> pyevtk<span class="ansi-yellow-intense-fg ansi-bold">.</span>hl <span class="ansi-green-intense-fg ansi-bold">import</span> gridToVTK
<span class="ansi-green-fg">     22</span> <span class="ansi-red-intense-fg ansi-bold"># Coordinates</span>
<span class="ansi-green-fg">     23</span> x <span class="ansi-yellow-intense-fg ansi-bold">=</span> np<span class="ansi-yellow-intense-fg ansi-bold">.</span>arange<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> extent_x <span class="ansi-yellow-intense-fg ansi-bold">+</span> <span class="ansi-cyan-intense-fg ansi-bold">0.1</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>delx<span class="ansi-yellow-intense-fg ansi-bold">,</span> delx<span class="ansi-yellow-intense-fg ansi-bold">,</span> dtype<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#39;float64&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-red-intense-fg ansi-bold">ImportError</span>: No module named &#39;pyevtk&#39;
</pre></div></div>
</div>
</div>
<div class="section" id="Performance-Analysis">
<h1>Performance Analysis<a class="headerlink" href="#Performance-Analysis" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="CPU">
<h2>CPU<a class="headerlink" href="#CPU" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>%%timeit
sol =  interpolator.geoMigueller(dips,dips_angles,azimuths,polarity, rest, ref)[0]
</pre></div>
</div>
</div>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>sandstone.block_export.profile.summary()
</pre></div>
</div>
</div>
</div>
<div class="section" id="GPU">
<h2>GPU<a class="headerlink" href="#GPU" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>%%timeit
# Reset the block
sandstone.block.set_value(np.zeros_like(sandstone.grid[:,0]))

# Compute the block
sandstone.compute_block_model([0,1,2], verbose = 0)
</pre></div>
</div>
</div>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>sandstone.block_export.profile.summary()
</pre></div>
</div>
</div>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../GeMpy Introduction.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Sandstone Model</a><ul>
<li><a class="reference internal" href="#Plotting-raw-data">Plotting raw data</a></li>
<li><a class="reference internal" href="#Class-Interpolator">Class Interpolator</a></li>
<li><a class="reference internal" href="#Early-granite">Early granite</a></li>
<li><a class="reference internal" href="#BIF-Series">BIF Series</a></li>
<li><a class="reference internal" href="#SImple-mafic">SImple mafic</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Optimizing-the-export-of-lithologies">Optimizing the export of lithologies</a></li>
<li><a class="reference internal" href="#Export-vtk">Export vtk</a></li>
<li><a class="reference internal" href="#Performance-Analysis">Performance Analysis</a><ul>
<li><a class="reference internal" href="#CPU">CPU</a></li>
<li><a class="reference internal" href="#GPU">GPU</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../GeMpy Introduction.html">Documentation overview</a><ul>
      <li>Previous: <a href="../tutorial.html" title="previous chapter">Tutorial</a></li>
      <li>Next: <a href="../project.html" title="next chapter">Project</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/Notebook1/Sandstone Project.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Miguel de la Varga. NRE-RWTH team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="../_sources/Notebook1/Sandstone Project.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>